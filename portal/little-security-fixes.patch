--- a/usr/share/perl5/Lemonldap/NG/Portal/Auth/SAML.pm
+++ b/usr/share/perl5/Lemonldap/NG/Portal/Auth/SAML.pm
@@ -1540,8 +1540,13 @@ sub getIDP {
     # Lazy load IDP
     $self->lazy_load_entityid($idp) if $idp;
 
-    # Case 6: auto select IDP if only one IDP defined
-    if ( scalar keys %{ $self->idpList } == 1 ) {
+    # Case 6: auto select IDP if only one IDP defined and WAYF is disabled
+    if (
+        scalar keys %{ $self->idpList } == 1
+        and not( $self->conf->{samlDiscoveryProtocolActivation}
+            and defined $self->conf->{samlDiscoveryProtocolURL} )
+      )
+    {
         ($idp) = keys %{ $self->idpList };
         $self->logger->debug("Selecting the only defined SAML IDP: $idp");
     }
--- a/usr/share/perl5/Lemonldap/NG/Portal/Issuer/OpenIDConnect.pm
+++ b/usr/share/perl5/Lemonldap/NG/Portal/Issuer/OpenIDConnect.pm
@@ -361,6 +361,12 @@ sub run {
                     return PE_UNAUTHORIZEDURL;
                 }
             }
+            elsif ($redirect_uri) {
+                $self->logger->error(
+"RP $rp has no RedirectUris, unable to handle accept redirect_uri=$redirect_uri"
+                );
+                return PE_UNAUTHORIZEDURL;
+            }
 
             # Check if flow is allowed
             if ( $flow eq "authorizationcode"
--- a/usr/share/perl5/Lemonldap/NG/Portal/Main/Init.pm
+++ b/usr/share/perl5/Lemonldap/NG/Portal/Main/Init.pm
@@ -120,7 +120,7 @@ sub init {
             my $lang = $1 || 'all';
             $self->trOver->{$lang}->{"PE$2"} = $self->localConfig->{$k};
         }
-        elsif ( $k =~ /msg_(?:(\w+?)_)?(\w+)$/ ) {
+        elsif ( $k =~ /msg_(?:([a-z][a-z](?:_[A-Z][A-Z])?)_)?(\w+)$/ ) {
             my $lang = $1 || 'all';
             $self->trOver->{$lang}->{$2} = $self->localConfig->{$k};
         }
